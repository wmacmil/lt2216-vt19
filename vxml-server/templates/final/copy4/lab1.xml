<?xml version="1.0" encoding="UTF-8" ?>
<vxml version="2.0">

  <nomatch>
    I didn't understand.
  </nomatch>
  
  <noinput>
    You didn't say anything.
  </noinput>

  <script> <![CDATA[ 

    var g1;
    var g2;
    var count = 1;
    var l = 2;

    var rlist;

    <!-- side effect only -->
    function randList(len) {
      var min=0; 
      var max=10 * count;  
      var localList = [];
      for (i = 0; i < len; i++) { 
        localList.push(Math.floor(Math.random() * (+max - +min)) + +min); 
      }
      rlist = localList
      <!-- how to ntimes this ?-->
      loc = ""
      for (i = 0; i < (len - 1); i++) { 
        loc += rlist[i] + "and";
      }
      <!-- loc = rlist[0] + "and" + rlist[1]; -->
      return loc + rlist[len];
      <!-- return  rlist[0] + "and" + rlist[1]; -->
    }    


    function retRand() {
      var min=0; 
      var max=10 * count;  
      <!-- randList(2); -->
      g1 = Math.floor(Math.random() * (+max - +min)) + +min; 
      return g1;
    }    

    function retRand2() {
      var min=0; 
      var max=10 * count;  
      g2 = Math.floor(Math.random() * (+max - +min)) + +min; 
      count += 1;
      return g2;
    }    
  
    var g3;
    var op;
    <!-- no const in emca < 2015 -->
    <!-- sequential operations were confusing, seperation of semantic elements -->

    function retRandOp() {
      g3 = Math.random();
      if (g3 > 0.5) {
        return "plus";
      } else {
        return "times";
      }
    }    

    <!-- semantics -->
    function yourNum(futureVal) {
      if (g3 > 0.5) {
        <!-- op = g1 + g2; -->
        op = rlist[0] + rlist[1]
      } else {
        <!-- op = g1 * g2; -->
        op = rlist[0] * rlist[1]
      }
      var correct = op;
      if (correct == futureVal) {
        return futureVal + "is correct" + rlist[rlist.length - 1];
        <!-- return futureVal + "is correct"; -->
      } else {
        return futureVal + "is incorrect. The correct value is " + correct;
        <!-- return futureVal + "is incorrect. The correct value is " + correct; -->
      }
    }    

  ]]> </script> 

  <form id="computePresentValue">  

    <field name="fv" type="digits">
      <prompt>
        What is the <value expr="retRandOp() "/> of 
        <!-- <value expr="retRand() "/> and <value expr="retRand2() "/>? -->
        <value expr="randList(2) "/>?
      </prompt>
    </field> 

    <filled> 
      <prompt> 
        Your value of 
        <value expr="yourNum(fv) "/>.
      </prompt> 
      <goto next="#computePresentValue" />
      <!-- <goto next="#computePresentValue1" /> -->
    </filled> 

  </form> 

  <form id="computePresentValue1">  

    <field name="fv1" type="digits">
      <prompt>
        What is the sum of 
        <value expr="retRand() "/> and <value expr="retRand2() "/>?
      </prompt>
    </field> 

    <filled> 
      <prompt> 
        Your value of <value expr="fv1"/> is
        <value expr="yourNum(fv1) "/>.
      </prompt> 
    </filled> 

  </form> 

</vxml>

